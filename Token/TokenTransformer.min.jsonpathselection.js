function sjeClass(){return new ValueTransformer}var ValueTransformer=function(){this.displayName="JSON Path Selection",this.shortDescription="Extract value from json responses or nodes using jsonPath.",this.isEditingDisabled=!0,this.infoUrl="https://github.com/SmartJSONEditor/PublicDocuments/wiki/Token-Value-Transformer",this.parameters=function(e){if(null==e)return[];var a=DocumentModel.getUserParameterValue("JsonPathSelection.values");null===a&&(a=null);var t={name:"selectionPopup",type:"Popup",displayName:"Select JSON Path Value",description:"Select function type",defaultValue:a},r=[];try{r=DocumentModel.getProjectIdList()}catch(e){r=[]}if(0==r.length){return[{name:"urlSection",type:"Section",displayName:"No Projects found ",description:"You do not have any project nodes yet"}]}for(var o=[],s=0;s<r.length;s++){var n=r[s];o.push({displayName:n.displayName,value:n.projectId,imageName:n.imageName})}return[{name:"mainTabs",type:"Tabs",displayName:"Tabs",defaultValue:[{id:"SELECT",displayName:"Select",parameters:[t,{name:"cache",type:"Bool",displayName:"Cache popup values",description:"Enable to cache values and improve performance.",defaultValue:!1}]},{id:"SETUP",displayName:"Setup",parameters:[{name:"projectId",type:"Popup",displayName:"Project Identifier",description:"Select Project Identifier",defaultValue:o},{type:"JsonPath",name:"jsonPathName",displayName:"Popup Display Name Json Path (Optional)",description:"Use space to initiate a json path search or use $ to access root element.",placeholder:"Use space to traverse",defaultValue:"",scriptsDisabled:!0,userInfo:{projectIdParameterName:"projectId"}},{type:"JsonPath",name:"jsonPathValue",displayName:"Value Json Path",description:"Use space to initiate a json path search or use $ to access root element.",placeholder:"Use space to traverse",defaultValue:"",scriptsDisabled:!0,userInfo:{projectIdParameterName:"projectId"}},{type:"Segments",name:"output",displayName:"Output",description:"Select how to output the value.",defaultValue:[{displayName:"Prepend",enabled:0},{displayName:"Replace",enabled:1},{displayName:"Append",enabled:0}]}]}],userInfo:{minimalUI:!0}}]},this.transform=function(e,a,t){DocumentModel.log(JSON.stringify(a));var r=a.projectId,o=a.jsonPathName,s=a.jsonPathValue,n=a.cache;if(void 0==r||""==r)return"Error-Project-id-parameter-is-undefined-x";var l=[],i=[];void 0==(l=DocumentModel.jsonPath(r,o))&&(l=[]),0==l.count&&(l=[]);void 0==(i=DocumentModel.jsonPath(r,s))&&(i=[]),0==i.count&&(i=[]);var u=r+":"+o+":"+s,p=DocumentModel.getUserParameterValue("JsonPathSelection.changeHash"),d=1==Array.isArray(a.selectionPopup)?"":a.selectionPopup;if(void 0===d&&(d="Error-undefined-value-x"),u!==p||!1===n){displayNameValueArray=[];for(var c in l){var m=l[c],h=null;1==m.isContainer?(h=m.toJavascriptValue(),h=JSON.stringify(h)):h=m.value,displayNameValueArray.push({displayName:h,value:""})}for(var c in i){var y=i[c],N=null;if(1==y.isContainer?(N=y.toJavascriptValue(),N=JSON.stringify(N)):N=y.value,c<l.length){var f=displayNameValueArray[c];f.displayName=f.displayName+" : "+N,f.value=N}else displayNameValueArray.push({displayName:N,value:N})}DocumentModel.setUserParameterValue("JsonPathSelection.values",displayNameValueArray),DocumentModel.setUserParameterValue("JsonPathSelection.changeHash",u)}return null==d&&(d=""),1==a.output[0].enabled?d+e:1==a.output[1].enabled?d:1==a.output[2].enabled?e+d:"Error-invalid-parameters-x"}};
